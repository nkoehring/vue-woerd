{"version":3,"file":"index.js","sources":["../src/htmlparser.js","../src/Woerd.js","../src/index.js"],"sourcesContent":["const selfClosing = ['img', 'br']\n\nfunction fromHTML (str, index = 0) {\n    let el = { tag: 'div', index, content: '', children: [] }\n  let ptr = 0\n  let tIdx = 0\n  let leaf = el\n  str = str.trim()\n\n  if (str[0] === '<') {\n    ptr = str.indexOf('>')\n    el.tag = str.slice(1, ptr++)\n  }\n\n  while (ptr < str.length) {\n    const c = str[ptr++]\n    const d = str[ptr]\n    const i = ptr\n\n    // tag opens\n    if (c === '<' && d !== '/') {\n      ptr = str.indexOf('>', i)\n      const snip = str.slice(i, ptr++)\n\n      // in case the element has properties (eg <a href> instead of just <a>)\n      const attrs = {}\n      const sepIdx = snip.indexOf(' ')\n      let startIdx = sepIdx + 1, endIdx, tag\n      let tmp = 3\n\n      if (sepIdx < 0) { // no properties, easy peasy\n        tag = snip\n      } else {          // has properties, shizzle damnizzle\n        tag = snip.slice(0, sepIdx)\n        while (tmp--) {\n          endIdx = snip.indexOf('=', startIdx)\n\n          if (endIdx < 0) break\n          const key = snip.slice(startIdx, endIdx)\n\n          startIdx = endIdx + 2\n          endIdx = snip.indexOf('\"', startIdx)\n          attrs[key] = snip.slice(startIdx, endIdx)\n\n          startIdx = endIdx + 2\n        }\n      }\n\n      const parent = leaf\n      leaf = { tag, attrs, index: leaf.content.length, content: '', children: [] }\n      leaf.parent = parent\n      parent.children.push(leaf)\n\n      if (selfClosing.indexOf(tag) >= 0) leaf = parent\n\n    // tag closes\n    } else if (c === '<' && d === '/') {\n      ptr = str.indexOf('>', i)\n      const closingTag = str.slice(i+1, ptr++)\n      if (closingTag !== leaf.tag)\n        console.warn('Malformed HTML! Expected', leaf.tag, 'but got', closingTag)\n      else leaf = leaf.parent\n\n    // text node\n    } else {\n      ptr = str.indexOf('<', ptr)\n      leaf.content += c + str.slice(i, ptr)\n      if (ptr === -1) ptr = str.length\n    }\n  }\n\n  return el\n}\n\nexport default fromHTML\n","import HTMLParser from './htmlparser'\n\n// usage: createNativeEl(document, \"div\", {attrs: {/*attributes*/}}, [/*children*/])\nfunction createNativeEl(d, tag, attrs, children) {\n  const el = d.createElement(tag)\n  const keys = Object.keys(attrs)\n\n  for (let i = 0; i < keys.length; i++) {\n    const k = keys[i]\n    const v = attrs[k]\n    el.setAttribute(k, v)\n  }\n  for (let i = 0; i < children.length; i++) el.appendChild(children[i])\n\n  return el\n}\n\n\n/*\n * tags to support: p, a, b, i, s, img, h[1-6], hr\n *\n * <p>Hello <i>World</i>. This <s>was</s><b>is</b> a <i>test</i>.<img src=\"foo.svg\" alt=\"some image\"></p>\n * becomes\n * const content = [\n *   { tag: 'p', index: 0, attrs: {}, content: 'Hello . This  a .', children: [\n *     { tag: 'i', index: 6, attrs: {}, content: 'World', children: [] },\n *     { tag: 's', index: 13, attrs: {}, content: 'was', children: [] },\n *     { tag: 'b', index: 13, attrs: {}, content: 'is', children: [] },\n *     { tag: 'i', index: 16, attrs: {}, content: 'test', children: [] },\n *     { tag: 'img', index: 17, attrs: {src:'foo.svg', alt:'some image'}, content: '', children: [] }\n *   ]},\n * ]\n * and vice versa\n */\n\n// usage: fromVDOM (vdomNode) -> woerdNode\nexport function fromVDOM (node, index = 0) {\n  const tag = node.tag\n  const attrs = node.data.attrs\n  let content = \"\"\n  let children = []\n\n  for (let i = 0; i < node.children.length; i++) {\n    const c = node.children[i]\n    if (c.text) content += c.text\n    else if (c.tag) children.push(fromVDOM(c, content.length))\n  }\n\n  return { tag, index, attrs, content, children }\n}\n\n// usage: toVDOM (createElementFunc, woerdNode) -> vdomNode\nexport function toVDOM (h, node) {\n  const text = node.content\n  let nodes = []\n  let lastIdx = 0\n\n  for (let i = 0; i < node.children.length; i++) {\n    const c = node.children[i]\n    nodes.push(text.slice(lastIdx, c.index))\n    nodes.push(toVDOM(h, c))\n    lastIdx = c.index\n  }\n\n  nodes.push(text.slice(lastIdx))\n  return h(node.tag, {attrs: node.attrs}, nodes)\n}\n\n// usage: fromNative (HTMLElement) -> woerdNode\nexport function fromNative (node, index = 0) {\n  const tag = node.tagName\n  const attrs = {}\n  let content = \"\"\n  let children = []\n\n  for (let i = 0; i < node.attributes.length; i++) {\n    const attr = node.attributes[i]\n    attrs[attr.name] = attr.value\n  }\n\n  for (let i = 0; i < node.childNodes.length; i++) {\n    const c = node.childNodes[i]\n    if (c.nodeType === c.TEXT_NODE)\n      content += c.textContent\n    else if (c.nodeType === c.ELEMENT_NODE)\n      children.push(fromNative(c, content.length))\n  }\n\n  return { tag, index, attrs, content, children }\n}\n\n// usage: toNative ({createElementFunc, createTextNodeFunc}, woerdNode) -> HTMLElement\nexport function toNative (d, node) {\n  const createEl = d.createElement\n  const createTxt = d.createTextNode.bind(d)\n\n  const text = node.content\n  let nodes = []\n  let lastIdx = 0\n\n  for (let i = 0; i < node.children.length; i++) {\n    const c = node.children[i]\n    nodes.push(createTxt(text.slice(lastIdx, c.index)))\n    nodes.push(toNative(d, c))\n    lastIdx = c.index\n  }\n\n  nodes.push(createTxt(text.slice(lastIdx)))\n  return createNativeEl(d, node.tag, node.attrs, nodes)\n}\n","import * as w from './Woerd'\nimport HTMLParser from './htmlparser'\n\nconst Woerd = {\n  HTMLParser,\n  fromVDOM: w.fromVDOM,\n  toVDOM: w.toVDOM,\n  fromNative: w.fromNative,\n  toNative: w.toNative\n}\n\nexport default Woerd\n"],"names":["HTMLParser","w.fromVDOM","w.toVDOM","w.fromNative","w.toNative"],"mappings":"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"}